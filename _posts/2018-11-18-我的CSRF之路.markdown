---
layout: post
title:  Csrf的读取—增删改查-组合拳
date: 2018-11-18 10:28:24.000000000 +08:00
---
##前面是扫盲后面会讲利用的姿势
#### What is CSRF?
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=554244265&auto=1&height=66"></iframe>
+	扫盲
`CSRF`(Cross-site request forgery)跨站请求伪造，也被称为“One Click Attack”或者Session Riding，通常缩写为CSRF或者XSRF
这么听起来好像不是那么好理解，我们举个例子
 `小明 和 小红 和 面部解锁 `的故事 
一天小明去小红家玩，小红这时在睡觉没有发现小明偷偷拿起了她的手机，因为她的手机有面部解锁，只需要刷一下小红的脸就可以了，机制的小明在小红睡觉的时候吧手机放在她面前。小红在睡梦中受到了这次攻击，手机解锁成功，而我们应该如何防护这一安全问题呢？这时某家手机厂商发布了新的技术，这个技术就是当你解锁的时候验证手机的来源，比如是否能匹配你的手表或者戒指其他东西，来证明是你主动得解锁，也就是证明解锁的人是你，这样小明得利用就比较难了，但是也并不是没有办法，比如使用偷走小红的手表等等，此时手机厂商又推出了新的功能那就是用户的凭证，每一次都会进行凭证的验证，当每一次用户解锁手机的时候手表需要从服务端取回数据，然后再用手表中的作为凭证去做面容解锁，而且每一个数据只能使用一次。这样不能仅仅靠小明的那一双手能够越过的了，但是也不是没有办法，那么故事讲完了我们来分析一下各个事物在`CSRF`攻击中相当于什么东西吧~首先 
小明攻击者 小红受害者这里我们把小红的脸部也就是我们的`cookie`或者是一种识别我们用户的标识。手表这样用于验证也就是`Referer` 那么`token`就是服务端生成的数据了

#### How to dig csrf vulnerability ?
+	实例：我们用一个csrf实例来进入我们的讲解过程[wooyun-csrf实例](http://www.anquan.us/static/bugs/wooyun-2015-0164067.html)
![csrf_1]({{ "/assets/images/csrf_1.png"|csrf_1}})
![csrf_2]({{ "/assets/images/csrf_2.png"|csrf_2}})
上面这个例子是我在wooyun找到的以往的一个csrf漏洞，那么我们画一张流程图模拟一下他的挖掘流程和大体思路。

